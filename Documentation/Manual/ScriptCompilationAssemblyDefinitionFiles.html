<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="Assembly definitions - Unity 手册">
<title>Assembly definitions - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2020.3/uploads/Main/ScriptCompilation.png">
<meta name="description" content="Assembly Definitions and Assembly References are assets that you can create to organize your scripts into assemblies.">
<meta property="og:description" content="Assembly Definitions and Assembly References are assets that you can create to organize your scripts into assemblies.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'ScriptCompilationAssemblyDefinitionFiles';
      if(!page) page = 'index';
      var version = '2020.3';
      var docs_versions = [{version: '2021.1',version_string: '2021.1',supported: true},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2020.3/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ScriptCompilationAssemblyDefinitionFiles.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2020.3/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html">English</a></li>
<li><a data-lang="cn" href="/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">日本語</a></li>
<li><a data-lang="es" href="/es/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ScriptCompilationAssemblyDefinitionFiles.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual 2020.3 (LTS)</a></li>
<li><a href="ScriptingSection.html">Scripting</a></li>
<li><a href="unity-architecture.html">Unity architecture</a></li>
<li><a href="script-compilation.html">Script compilation</a></li>
<li>Assembly definitions</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="PlatformDependentCompilation.html"></a></span><div class="tip">平台相关的编译</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-AssemblyDefinitionImporter.html"></a></span><div class="tip">程序集定义 (Assembly Definition) 属性</div>
</div>
</div></div>
<h1>Assembly definitions</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Assembly Definitions and Assembly References are assets that you can create to organize your scripts into assemblies.</p>

<p>An assembly is a C# code library that contains the compiled classes and structs that are defined by your scripts and which also define references to other assemblies. See <a href="https://docs.microsoft.com/en-us/dotnet/standard/assembly/">Assemblies in .NET</a> for general information about assemblies in C#.</p>

<p>By default, Unity compiles almost all of your game scripts into the <em>predefined</em> assembly, <em>Assembly-CSharp.dll</em>. (Unity also creates a <a href="ScriptCompileOrderFolders.html">few smaller, specialized predefined assemblies</a>.)</p>

<p>This arrangement works acceptably for small projects, but has some drawbacks as you add more code to your project:</p>

<ul>
<li>Every time you change one script, Unity has to recompile all the other scripts, increasing overall compilation time for iterative code changes.</li>
<li>Any script can directly access types defined in any other script, which can make it more difficult to refactor and improve your code.</li>
<li>All scripts are compiled for all platforms.</li>
</ul>

<p>By defining assemblies, you can organize your code to promote modularity and reusability. Scripts in the assemblies you define for your project are no longer added to the default assemblies and can only access scripts in those other assemblies that you designate.</p>

<figure>
<img src="../uploads/Main/ScriptCompilation.png" alt="">
</figure>

<p>The above diagram illustrates how you might split up the code in your project into multiple assemblies. Because <em>Main</em> references <em>Stuff</em> and not the other way around, you know that any changes to the code in <em>Main</em> cannot affect the code in <em>Stuff</em>. Similarly, because <em>Library</em> doesn’t depend on any other assemblies, you can more easily reuse the code in <em>Library</em> in another project. </p>

<p>This section discusses how to create and set up Assembly Definition and Assembly Reference assets to define assemblies for your project:</p>

<ul>
<li><a href="#defining-assemblies">Defining assemblies</a></li>
<li><a href="#reference-and-assemblies">References and dependencies</a></li>
<li><a href="#create-asmdef">Creating an Assembly Definition asset</a></li>
<li><a href="#create-asmref">Creating an Assembly Definition Reference asset</a></li>
<li><a href="#create-platform-specific">Creating a platform-specific assembly</a></li>
<li><a href="#create-editor-assembly">Creating an assembly for Editor code</a></li>
<li><a href="#create-test-assembly">Creating a test assembly</a></li>
<li><a href="#reference-another-assembly">Referencing another assembly</a></li>
<li><a href="#reference-precompiled-assembly">Referencing a precompiled, plugin assembly</a></li>
<li><a href="#conditional-assembly">Conditionally building an assembly</a></li>
<li><a href="#define-symbols">Defining symbols based on project packages</a></li>
<li><a href="#find-assembly">Finding which assembly a script belongs to</a></li>
<li><a href="#special-folders">Special folders</a></li>
<li><a href="#get-assembly-info">Getting assembly information in build scripts</a></li>
</ul>

<p>另请参阅：</p>

<ul>
<li><a href="class-AssemblyDefinitionImporter.html">Assembly Definition properties</a></li>
<li><a href="class-AssemblyDefinitionImporter.html#assembly-definition-reference-properties">Assembly Definition Reference properties</a></li>
<li><a href="AssemblyDefinitionFileFormat.html">Assembly Definition File Format</a></li>
</ul>

<p><a name="defining-assemblies"></a></p>

<h2>Defining assemblies</h2>

<p>To organize your project code into assemblies, create a folder for each desired assembly and move the scripts that should belong to each assembly into the relevant folder. Then <a href="#create-asmdef">create Assembly Definition assets</a> to specify the assembly properties.</p>

<p>Unity takes all of the scripts in a folder that contains an Assembly Definition asset and compiles them into an assembly, using the name and other settings defined by the asset. Unity also includes scripts in any child folders in the same assembly, unless the child folder has its own Assembly Definition or Assembly Reference asset. </p>

<p>To include scripts from a non-child folder in an existing assembly, create an Assembly Reference asset in the non-child folder and set it to reference the Assembly Definition asset that defines the target assembly. For example, you can combine the scripts from all the Editor folders in your project in their own assembly, no matter where those folders are located.</p>

<p>Unity compiles assemblies in an order determined by their dependencies; you cannot specify the order in which compilation takes place.</p>

<p><a name="reference-and-assemblies"></a></p>

<h2>References and dependencies</h2>

<p>When one type (such as a class or struct) uses another type, the first type is <em>dependent</em> on the second. When Unity compiles a script, it must also have access to any types or other code the script depends upon. Likewise, when the compiled code runs, it must have access to the compiled versions of its dependencies. If two types are in different assemblies, an assembly containing a dependent type must declare a <em>reference</em> to the assembly containing the type upon which it depends.</p>

<p>You can control the references between assemblies used in your project using the options of an Assembly Definition. The Assembly Definition settings include:</p>

<ul>
<li>
<a href="class-AssemblyDefinitionImporter.html#general">Auto Referenced</a> – Whether the predefined assemblies reference the assembly</li>
<li>
<a href="class-AssemblyDefinitionReferenceImporter.html">Assembly Definition References</a> – References to other project assemblies created with Assembly Definitions</li>
<li>
<a href="class-AssemblyDefinitionImporter.html#general">Override References</a> + <a href="#reference-another-assembly">Assembly References</a> – References to precompiled (plugin) assemblies</li>
<li>
<a href="class-AssemblyDefinitionImporter.html#general">No Engine References</a> – References to UnityEngine assemblies</li>
</ul>

<p><strong>Note:</strong> Classes in assemblies created with an Assembly Definition cannot use types defined in the predefined assemblies.</p>

<p><a name="default-references"></a></p>

<h3>Default references</h3>

<p>By default, the predefined assemblies reference all other assemblies, including those created with Assembly Definitions (1) and precompiled assemblies added to the project as plugins (2). In addition, assemblies you create with an Assembly Definition asset automatically reference all precompiled assemblies (3):</p>

<figure>
<img src="../uploads/Main/AssemblyDependencies.png" alt="">
</figure>

<p>In the default setup, classes in the predefined assemblies can use all types defined by any other assemblies in the project. Likewise, assemblies you create with an Assembly Definition asset can use all types defined in any precompiled (plug-in) assemblies.</p>

<p>You can prevent an assembly from being referenced by the predefined assemblies by turning off the <a href="class-AssemblyDefinitionImporter.html#general">Auto Referenced option</a> in the Inspector for an Assembly Definition asset. Turning off auto-referenced means that the predefined assemblies are not recompiled when you change code in the assembly, but also means that the predefined assemblies cannot use code in this assembly directly. See <a href="class-AssemblyDefinitionImporter.html">Assembly Definition properties</a>.</p>

<p>Likewise, you can prevent a plugin assembly from being automatically referenced by turning off the <a href="PluginInspector.html">Auto Referenced property</a> in the <a href="PluginInspector.html">Plugin Inspector</a> for a plugin asset. This affects both predefined assemblies and those you create with an Assembly Definition. For more information, see <a href="PluginInspector.html">Plugin Inspector</a>.</p>

<p>When you turn off <strong>Auto Referenced</strong> for a <strong>plug-in</strong>, you can explicitly reference it in the Inspector for an Assembly Definition asset. Enable the asset’s <a href="class-AssemblyDefinitionImporter.html#general">Override References</a> option and add a reference to the <strong>plug-in</strong>. See <a href="class-AssemblyDefinitionImporter.html">Assembly Definition properties</a>.</p>

<p><strong>Note:</strong> You cannot declare explicit references for the precompiled assemblies. The predefined assemblies can only use code in auto-referenced assemblies.</p>

<p><a name="cyclical-references"></a></p>

<h3>Cyclical references</h3>

<p>A cyclical assembly reference exists when one assembly references a second assembly that, in turn, references the first assembly. Such cyclical references between assemblies are not allowed and are reported as an error with the message, “Assembly with cyclic references detected.”</p>

<p>Typically, such cyclical references between assemblies occur because of cyclical references within the classes defined in the assemblies. While there is nothing technically invalid about cyclical references between classes in the same assembly, cyclical references between classes in different assemblies are not allowed. If you encounter a cyclical reference error, you must refactor your code to remove the cyclical reference or to put the mutually referencing classes in the same assembly. </p>

<p><a name="create-asmdef"></a> </p>

<h2>Creating an Assembly Definition asset</h2>

<p>To create an Assembly Definition asset:</p>

<ol>
<li>In the <strong>Project</strong> window, locate the folder containing the scripts you want to include in the assembly.</li>
<li>Create an Assembly Definition asset in the folder (menu: <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Assembly Definition</strong>).</li>
<li>Assign a name to the asset. By default, the assembly file uses the name you assign to the asset, but you can change the name in the <strong>Inspector</strong> window.</li>
</ol>

<p>Unity recompiles the scripts in the project to create the new assembly. Once it has finished, you can change the settings for the new Assembly Definition.</p>

<p>The scripts in the folder containing the Assembly Definition, including scripts in any child folders (unless those folders contain their own Assembly Definition or Reference assets), are compiled into the new assembly and removed from their previous assembly.</p>

<p><a name="create-asmref"></a> </p>

<h2>Creating an Assembly Definition Reference asset</h2>

<p>To create an Assembly Definition Reference asset:</p>

<ol>
<li><p>In the <strong>Project</strong> window, locate the folder containing the scripts you want to include in the referenced assembly.</p></li>
<li><p>Create an Assembly Reference asset in the folder (menu: <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Assembly Definition Reference</strong>).</p></li>
<li>
<p>Assign a name to the asset.</p>

<p>Unity recompiles the scripts in the project to create the new assembly. Once it has finished, you can change the settings for the new Assembly Definition Reference.</p>
</li>
<li>
<p>Select the new Assembly Definition Reference asset to view its properties in the <strong>Inspector</strong>.</p>

<figure>
<img src="../uploads/Main/asmdef-2.png" alt="">
</figure>
</li>
<li><p>Set the Assembly Definition property to reference the target Assembly Definition asset.</p></li>
<li><p>Click <strong>Apply</strong>.</p></li>
</ol>

<p>The scripts in the folder containing the Assembly Definition Reference asset, including scripts in any child folders (unless those folders contain their own Assembly Definition or Reference assets) are compiled into the referenced assembly and removed from their previous assembly.</p>

<p><a name="create-platform-specific"></a></p>

<h2>Creating a platform-specific assembly</h2>

<p>To create an assembly for a specific platform:</p>

<ol>
<li><p><a href="#create-asmdef">Create an Assembly Definition asset</a>.</p></li>
<li>
<p>Select the new Assembly Definition Reference asset to view its properties in the <strong>Inspector</strong>.</p>

<figure>
<img src="../uploads/Main/asmdef-3.png" alt="">
</figure>
</li>
<li><p>Check the <strong>Any Platform</strong> option and choose specific platforms to exclude. Alternately, you can uncheck Any Platform and choose specific platforms to include.</p></li>
<li><p>Click <strong>Apply</strong>.</p></li>
</ol>

<p>The assembly will be included (or excluded) according to the selected platforms when you build your project for a platform.</p>

<p><a name="create-editor-assembly"></a></p>

<h2>Creating an assembly for Editor code</h2>

<p>Editor assemblies allow you to put your Editor scripts anywhere in the project, not just in top-level folders named, <em>Editor</em>.</p>

<p>To create an assembly that contains the Editor code in your project:</p>

<ol>
<li>
<a href="#create-platform-specific">Create a platform-specific assembly</a> in a folder containing your Editor scripts.</li>
<li>Include ONLY the Editor platform.</li>
<li>If you have additional folders containing Editor scripts, <a href="#create-asmref">create Assembly Definition Reference assets</a> in those folders and set them to reference this Assembly Definition.</li>
</ol>

<p><a name="create-test-assembly"></a></p>

<h2>Creating a test assembly</h2>

<p>Test assemblies allow you to write tests and run them with the Unity TestRunner, while also keeping your test code separate from the code you ship with your application. Unity provides the TestRunner as part of the <a href="https://docs.unity3d.com/Manual/com.unity.test-framework.html">Test Framework package</a>. See the <a href="https://docs.unity3d.com/Packages/com.unity.test-framework@latest?subfolder=/manual/workflow-create-test-assembly.html">Test Framework documentation</a> for instructions on installing the Test Framework package and creating test assemblies. </p>

<p><a name="reference-another-assembly"></a></p>

<h2>Referencing another assembly</h2>

<p>To use the C# types and functions that are part of another assembly, you must create a reference to that assembly in the Assembly Definition asset.</p>

<p>To create an assembly reference:</p>

<ol>
<li><p>Select the Assembly Definition for the assembly that requires the reference to view its properties in the <strong>Inspector</strong>.</p></li>
<li>
<p>In the <strong>Assembly Definition References</strong> section, click the <strong>+</strong> button to add a new reference.</p>

<figure>
<img src="../uploads/Main/asmdef-4.png" alt="">
</figure>
</li>
<li><p>Assign the Assembly Definition asset to the newly created slot in the list of references.</p></li>
</ol>

<p>Enabling the <strong>Use GUIDs</strong> option allows you to change the filename of the referenced Assembly Definition asset without updating references in other Assembly Definitions to reflect the new name. (Note that GUIDs must be reset if the metadata files for the asset files are deleted or you move the files outside the Unity Editor without also moving the metadata files along with them.)</p>

<p><a name="reference-precompiled-assembly"></a></p>

<h2>Referencing a precompiled, plugin assembly</h2>

<p>By default, all assemblies in your project created with Assembly Definitions automatically reference all precompiled assemblies. These automatic references mean that Unity must recompile all your assemblies when you update any one of the precompiled assemblies, even if the code in the assembly is not used. To avoid this extra overhead, you can override the automatic references and specify references to only those precompiled libraries the assembly actually uses:</p>

<ol>
<li><p>Select the Assembly Definition for the assembly that requires the reference to view its properties in the <strong>Inspector</strong>.</p></li>
<li>
<p>In the <strong>General</strong> section, enable the <strong>Override References</strong> option.</p>

<figure>
<img src="../uploads/Main/asmdef-5.png" alt="">
</figure>

<p>The <strong>Assembly References</strong> section of the <strong>Inspector</strong> becomes available when <strong>Override References</strong> is checked.</p>
</li>
<li><p>In the <strong>Assembly References</strong> section, click the <strong>+</strong> button to add a new reference.</p></li>
<li>
<p>Use the drop-down list in the empty slot to assign a reference to a precompiled assembly. The list shows all the precompiled assemblies in the project for the platform currently set in the project <a href="BuildSettings.html">Build Settings</a>. (Set the platform compatibility for a precompiled assembly in the <a href="PluginInspector.html">Plugin Inspector</a>.)</p>

<figure>
<img src="../uploads/Main/asmdef-6.png" alt="">
</figure>
</li>
<li><p>Click <strong>Apply</strong>.</p></li>
<li><p>Repeat for each platform for which you build your project.</p></li>
</ol>

<p><a name="conditional-assembly"></a></p>

<h2>Conditionally including an assembly</h2>

<p>You can use preprocessor symbols to control whether an assembly is compiled and included in builds of your game or application (including play mode in the Editor). You can specify which symbols must be defined for an assembly to be used with the <strong>Define Constraints</strong> list in the Assembly Definition options:</p>

<ol>
<li><p>Select the Assembly Definition for the assembly to view its properties in the <strong>Inspector</strong>.</p></li>
<li>
<p>In the <strong>Define Constraints</strong> section, click the <strong>+</strong> button to add a new symbol to the list of constraints.</p>

<figure>
<img src="../uploads/Main/asmdef-7.png" alt="">
</figure>
</li>
<li>
<p>Enter the symbol name.</p>

<p>You can “negate” the symbol by putting an exclamation point in front of the name. For example, the constraint, <code>!UNITY_WEBGL</code> would include the assembly when UNITY_WEBGL was NOT defined.</p>
</li>
<li><p>Click <strong>Apply</strong>.</p></li>
</ol>

<p>You can use the following symbols as constraints:</p>

<ul>
<li>Symbols defined in the <a href="class-PlayerSettingsStandalone.html#Configuration">Scripting Define Symbols</a> setting, which you can find in the <strong>Player</strong> section of your <strong>Project Settings</strong>. Note that the <strong>Scripting Define Symbols</strong> apply to the platform currently set in your project <a href="BuildSettings.html">Build Settings</a>. To define a symbol for multiple platforms, you must switch to each platform and modify the <strong>Scripting Define Symbols</strong> field individually.</li>
<li>Symbols defined by Unity. See <a href="PlatformDependentCompilation.html">Platform dependent compilation</a>.</li>
<li>Symbols defined using the <a href="#define-symbols">Version Defines</a> section of the Assembly Definition asset.</li>
</ul>

<p>Symbols defined in scripts are not considered when determining if a constraint has been satisfied.</p>

<p>See <a href="#define-constraints">Define Constraints</a> for additional information.</p>

<p><a name="define-symbols"></a></p>

<h2>Defining symbols based on project packages</h2>

<p>If you need to compile different code in an assembly according to whether a project uses specific packages or versions of a package, you can add entries to the <strong>Version Defines</strong> list. This list specifies rules for when a symbol should be defined. For version numbers, you can specify a logical expression that evaluates to a specific version or a range of versions.</p>

<p>To conditionally define a symbol:</p>

<ol>
<li><p>Select the Assembly Definition for the assembly to view its properties in the <strong>Inspector</strong>.</p></li>
<li><p>In the <strong>Version Defines</strong> section, click the <strong>+</strong> button to add an entry to the list.</p></li>
<li>
<p>Set the properties:</p>

<ul>
<li>
<strong>Resource</strong>: choose the package or module that must be installed in order for this symbol to be defined</li>
<li>
<strong>Define</strong>: the symbol name</li>
<li>
<strong>Expression</strong>: an expression that evaluates to a specific version or a range of versions. See <a href="#version-define-expressions">Version Define Expressions</a> for the rules.</li>
</ul>

<p>The <strong>Expression outcome</strong> shows which versions the expression evaluates to.</p>

<p>The following example defines the symbol, USE_TIMELINE, if the project uses Timeline 1.3.0 or later:</p>

<figure>
<img src="../uploads/Main/asmdef-8.png" alt="">
</figure>
</li>
<li><p>Click <strong>Apply</strong>.</p></li>
</ol>

<p>Symbols defined in the Assembly Definition are only in scope for the scripts in the assembly created for that definition.</p>

<p>Note that you can use the symbols defined using the <strong>Version Defines</strong> list as <strong>Define Constraints</strong>. Thus you could specify that an assembly is only to be used if specific versions of a given package are installed in the project.</p>

<p><a name="version-define-expressions"></a></p>

<h2>Version Define expressions</h2>

<p>You can use expressions to specify an exact version or a range of versions. A <strong>Version Define</strong> expression uses mathematical range notation. A square bracket, “[]” designates that the range includes the endpoint:</p>

<blockquote>
<p><code>[1.3,3.4.1]</code> evaluates to <code>1.3.0 &lt;= x &lt;= 3.4.1</code></p>
</blockquote>

<p>A parenthesis “()” designates that the range excludes the endpoint: </p>

<blockquote>
<p><code>(1.3.0,3.4)</code> evaluates to <code>1.3.0 &lt; x &lt; 3.4.0</code></p>
</blockquote>

<p>You can mix both range types in a single expression:</p>

<blockquote>
<p><code>[1.1,3.4)</code> evaluates to <code>1.1.0 &lt;= x &lt; 3.4.0</code></p>

<p><code>(0.2.4,5.6.2-preview.2]</code> evaluates to <code>0.2.4 &lt; x &lt;= 5.6.2.-preview.2</code></p>
</blockquote>

<p>You can use a single version designator in square brackets to designate an exact version:</p>

<blockquote>
<p><code>[2.4.5]</code> evaluates to <code>x = 2.4.5</code></p>
</blockquote>

<p>As a shortcut, you can enter a single version without range brackets to indicate that the expression includes that version or later:</p>

<blockquote>
<p><code>2.1.0-preview.7</code> evaluates to <code>x &gt;= 2.1.0-preview.7</code></p>
</blockquote>

<p>Version designators have four parts, following the <a href="https://semver.org/">Semantic Versioning</a> format: MAJOR.MINOR.PATCH-LABEL. The first three parts are always numbers, but the label is a string. Unity packages in preview use the string, <code>preview</code> or <code>preview.n</code>, where <code>n &gt; 0</code>. You must use at least the major and minor components of a version in an expression.</p>

<p><strong>Note:</strong> No spaces are allowed in an expression.</p>

<p><a name="find-assembly"></a></p>

<h2>Finding which assembly a script belongs to</h2>

<p>To identify which assembly one of your C# scripts is compiled into:</p>

<ol>
<li><p>Select the C# script file in the Unity <strong>Project</strong> window to view its properties in the <strong>Inspector</strong> window. </p></li>
<li>
<p>The assembly filename and the Assembly Definition, if one exists, are shown in the <strong>Assembly Information</strong> section of the <strong>Inspector</strong>.</p>

<figure>
<img src="../uploads/Main/asmdef-9.png" alt="">
</figure>
</li>
</ol>

<p>In this example, the selected script is compiled into the library file, Unity.Timeline.Editor.dll, which is defined by the Unity.Timeline.Editor Assembly Definition asset.</p>

<p><a name="special-folders"></a></p>

<h2>特殊文件夹</h2>

<p>Unity treats scripts in folders with certain, special names differently than scripts in other folders. However, one of these folders loses its special treatment when you create an Assembly Definition asset inside it or in a folder above it. You might notice this change when you use Editor folders, which might be scattered throughout your Project (depending on how you organize your code and on the Asset packages you use).</p>

<p>Unity normally compiles any scripts in folders named Editor into the predefined Assembly-CSharp-Editor assembly no matter where those scripts are located. However, if you create an Assembly Definition asset in a folder that has an Editor folder underneath it, Unity no longer puts those Editor scripts into the predefined Editor assembly. Instead, they go into the new assembly created by your Assembly Definition — where they might not belong. To manage Editor folders, you can create Assembly Definition or Reference assets in each Editor folder to place those scripts in one or more Editor assemblies. See <a href="#create-editor-assembly">Creating an assembly for Editor code</a>.</p>

<p><a name="set-assembly-attributes"></a></p>

<h2>Setting assembly attributes</h2>

<p>You can use assembly attributes to set metadata properties for your assemblies. By convention, assembly attribute statements are typically put in a file named AssemblyInfo.cs.</p>

<p>For example, the following assembly attributes specify a few <a href="https://docs.microsoft.com/en-us/dotnet/standard/assembly/set-attributes">.NET assembly metadata values</a>, an <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.internalsvisibletoattribute?view=netcore-2.0">InternalsVisibleTo</a> attribute, which can be useful for testing, and the Unity-defined <a href="ManagedCodeStripping.html#PreserveAttribute">Preserve attribute</a> that affects how unused code is removed from an assembly when you build your project:</p>

<pre><code class="csharp">[assembly: System.Reflection.AssemblyCompany("Bee Corp.")]
[assembly: System.Reflection.AssemblyTitle("Bee's Assembly")]
[assembly: System.Reflection.AssemblyCopyright("Copyright 2020.")]
[assembly: System.Runtime.CompilerServices.InternalsVisibleTo("UnitTestAssembly")]
[assembly: UnityEngine.Scripting.Preserve]
</code></pre>

<p><a name="get-assembly-info"></a></p>

<h2>Getting assembly information in build scripts</h2>

<p>Use the CompilationPipeline class, in the UnityEditor.Compilation namespace, to retrieve information about all assemblies built by Unity for a project, including those created based on Assembly Definition assets.</p>

<p>For example, the following script uses the CompilationPipeline class to list all the current Player assemblies in a project:</p>

<pre><code class="csharp">using UnityEditor;
using UnityEditor.Compilation;
public static class AssemblyLister
{
    [MenuItem("Tools/List Player Assemblies in Console")]
    public static void PrintAssemblyNames()
    {
        UnityEngine.Debug.Log("== Player Assemblies ==");
        Assembly[] playerAssemblies =
            CompilationPipeline.GetAssemblies(AssembliesType.Player);

        foreach (var assembly in playerAssemblies)
        {
            UnityEngine.Debug.Log(assembly.name);
        }
    }
}
</code></pre>
<!-- Start_links -->
<!-- End_links -->
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="PlatformDependentCompilation.html"></a></span><div class="tip">平台相关的编译</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-AssemblyDefinitionImporter.html"></a></span><div class="tip">程序集定义 (Assembly Definition) 属性</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2020 Unity Technologies. Publication 2020.3</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
